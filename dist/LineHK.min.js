(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{23:function(t,s,e){"use strict";e.r(s);var n=e(5),i=e(0),r=e(6),a=e(2);class h extends r.a{constructor(t,s){super(t,s),this.STN_NAME_Y=-10.5,this.STN_NAME_BASE_HEIGHT=30.390625,this.STN_NAME_LINE_GAP=14,this.STN_NAME_BG_ADJUST=.5}get nameHTML(){var t=this.name[1].split("\\");if(this.namePos)var s=this.STN_NAME_LINE_GAP-this.STN_NAME_Y-this.STN_NAME_BG_ADJUST;else s=-this.STN_NAME_LINE_GAP-this.STN_NAME_Y-this.STN_NAME_BASE_HEIGHT-10*(t.length-1);0===this.state&&$("#current_bg").attr({y:this.y+s+this.STN_NAME_Y-1.5+this._nameDY,height:this.STN_NAME_BASE_HEIGHT+10*(t.length-1)+2+1.5});for(var e=t.shift(),n=$("<text>",{dy:15,class:"rmg-name__en rmg-name__mtr--station"}).text(e);e=t.shift();)n.append($("<tspan>",{x:0,dy:10,"alignment-baseline":"middle"}).text(e));return $("<g>",{transform:`translate(${this.x+this._nameDX},${this.y+s+this._nameDY})`,"text-anchor":this._nameTxtAnchor,class:`Name ${this.nameClass}`}).append($("<text>").addClass("rmg-name__zh rmg-name__mtr--station").text(this.name[0])).append(n)}}class o extends h{constructor(t,s){super(t,s),this._intInfo=s.transfer.info[0][0]}get _dy(){return 0}get intTickHTML(){var t=this.namePos?180:0,s=this._intInfo[a.b.colour],e=$("<use>",{"xlink:href":"#inttick_hk",stroke:s,transform:`translate(${this.x},${this.y+this._dy})rotate(${t})`,class:"rmg-line rmg-line__mtr rmg-line__change"});return-1==this.state&&e.addClass("rmg-line__pass"),e}get _nameClass(){return-1==this.state?"Pass":"Future"}get intNameHTML(){var[t,s,e]=Object(i.h)([this._intInfo[a.b.nameZH],this._intInfo[a.b.nameEN]],10,7),n=this.namePos?-37.703125-13*(s-1)-7*(e-1):30.953125;return n+=this._dy,$("<g>",{"text-anchor":"middle",transform:`translate(${this.x},${this.y+n})`,class:`Name ${this._nameClass}`}).html(t[0])}get ungrpHTML(){return[this.intTickHTML,this.iconHTML,this.nameHTML,this.intNameHTML]}}class _ extends h{constructor(t,s){super(t,s),this._intInfos=s.transfer.info[0]}get iconHTML(){let t=this.namePos?180:0;return $("<use>",{"xlink:href":"#int3_hk",transform:`translate(${this.x},${this.y})rotate(${t})`,class:this.iconClass})}get _tickRotation(){return 0}get _dy(){return 0}get _dx(){return 0}get _tickFlip(){return 1}get intTickHTML(){let t=[];return this._intInfos.map(t=>t[a.b.colour]).forEach((s,e)=>{if(e>=2)return;let n=-1===this.state?"#aaa":s,i=this.namePos?-18*(2-e):18*(e+1);i+=this._dy,i*=this._tickFlip,t.push($("<use>",{"xlink:href":"#inttick_hk",stroke:n,transform:`translate(${this.x+this._dx},${this.y+i})rotate(${this._tickRotation})`,class:"rmg-line rmg-line__mtr rmg-line__change"}))}),t}get _txtAnchor(){return"middle"}get _intNameDX(){return 0}get _nameClass(){return-1==this.state?"Pass":"Future"}get intNameHTML(){let t=[],s=this._nameClass;return this._intInfos.map(t=>[t[a.b.nameZH],t[a.b.nameEN]]).forEach((e,n)=>{if(n>=2)return;let[r,a,h]=Object(i.h)(e,10,7);var o=this.namePos?-18*(2-n):18*(n+1);o+=this._dy,o*=this._tickFlip,o+=5.953125-(19.65625+13*(a-1)+7*(h-1))/2,t.push($("<g>",{"text-anchor":this._txtAnchor,transform:`translate(${this.x+this._intNameDX},${this.y+o})`,class:"Name "+s}).html(r[0]))}),t}get ungrpHTML(){return[...this.intTickHTML,this.iconHTML,this.nameHTML,...this.intNameHTML]}}class m extends _{get _tickRotation(){return 90}get _txtAnchor(){return"end"}get _intNameDX(){return-24}}class l extends _{get _tickRotation(){return-90}get _txtAnchor(){return"start"}get _intNameDX(){return 24}}class c extends o{constructor(t,s){s.transfer.info[0].push(s.transfer.info[1][0]),super(t,s),this._osiNames=s.transfer.osi_names[0],this._osiType=s.transfer.paid_area?"p":"u"}get osiClass(){return"u"==this._osiType?"rmg-stn__mtr--unpaid-osi":"rmg-stn__mtr--paid-osi"}get iconHTML(){var t=this.namePos?180:0;return $("<use>",{"xlink:href":"#osi11_hk",transform:`translate(${this.x},${this.y})rotate(${t})`,class:[this.iconClass,this.osiClass].join(" ")})}get _dy(){return this.namePos?-26:26}get _txtAnchor(){return"middle"}get _osiNameDX(){return 0}get osiNameHTML(){var t=this._dy+8.34375-12.515625;return $("<g>",{"text-anchor":this._txtAnchor,transform:`translate(${this.x+this._osiNameDX},${this.y+t})`,class:"Name "+this._nameClass}).append($("<text>").addClass("rmg-name__zh rmg-name__mtr--osi").text(this._osiNames[0])).append($("<text>",{x:0,dy:12,class:"rmg-name__en rmg-name__mtr--osi"}).text(this._osiNames[1]))}get ungrpHTML(){return[this.intTickHTML,this.iconHTML,this.nameHTML,this.intNameHTML,this.osiNameHTML]}}class g extends c{get _txtAnchor(){return"end"}get _osiNameDX(){return-13}}class d extends c{get _txtAnchor(){return"start"}get _osiNameDX(){return 13}}class u extends _{constructor(t,s){s.transfer.info[0].unshift(...s.transfer.info[1].slice(0,2)),super(t,s),this._osiNames=s.transfer.osi_names[0],this._osiType=s.transfer.paid_area?"p":"u"}get osiClass(){return"u"==this._osiType?"rmg-stn__mtr--unpaid-osi":"rmg-stn__mtr--paid-osi"}get iconHTML(){var t=this.namePos?180:0;return $("<use>",{"xlink:href":"#osi12_hk",transform:`translate(${this.x},${this.y})rotate(${t})`,class:[this.iconClass,this.osiClass].join(" ")})}get _dy(){return this.namePos?-8:8}get _osiDY(){return this.namePos?-70.6875:62.34375}get _osiTxtAnchor(){return"middle"}get _osiDX(){return 0}get osiNameHTML(){var t=-1==this.state?"Pass":"Future";return $("<g>",{"text-anchor":this._osiTxtAnchor,transform:`translate(${this.x+this._dx+this._osiDX},${this.y+this._osiDY})`,class:`Name ${t}`}).append($("<text>").addClass("rmg-name__zh rmg-name__mtr--osi").text(this._osiNames[0])).append($("<text>",{x:0,dy:12,class:"rmg-name__en rmg-name__mtr--osi"}).text(this._osiNames[1].split("\\")[0]).append($("<tspan>",{x:0,dy:10}).text(this._osiNames[1].split("\\")[1]||"")))}get ungrpHTML(){return[...this.intTickHTML,this.iconHTML,this.nameHTML,...this.intNameHTML,this.osiNameHTML]}}class p extends u{get _tickRotation(){return 90}get _txtAnchor(){return"end"}get _intNameDX(){return-24}}class x extends u{get _tickRotation(){return-90}get _txtAnchor(){return"start"}get _intNameDX(){return 24}}class N extends u{constructor(t,s){super(t,s),this._origIntInfo=s.transfer.info[0][2]}get _nameTxtAnchor(){return this._osiTxtAnchor}get _nameDY(){return this.namePos?11.515625:-11.515625}get origIntTickHTML(){var t=this.namePos?0:180,s=this._origIntInfo[a.b.colour],e=$("<use>",{"xlink:href":"#inttick_hk",stroke:s,transform:`translate(${this.x},${this.y})rotate(${t})`,class:"rmg-line rmg-line__mtr rmg-line__change"});return-1==this.state&&e.addClass("rmg-line__pass"),e}get origIntNameHTML(){var[t,s,e]=Object(i.h)([this._origIntInfo[a.b.nameZH],this._origIntInfo[a.b.nameEN]],10,7),n=this.namePos?30.953125:-37.703125-13*(s-1)-7*(e-1);return $("<g>",{"text-anchor":this._txtAnchor,transform:`translate(${this.x-this._nameDX},${this.y+n})`,class:`Name ${this._nameClass}`}).html(t[0])}get _osiNameDX(){return 0}get osiNameHTML(){var t=this._dy-(this.namePos?27:-27)+8.34375-12.515625;return $("<g>",{"text-anchor":this._osiTxtAnchor,transform:`translate(${this.x+this._osiNameDX},${this.y+t})`,class:"Name "+this._nameClass}).append($("<text>").addClass("rmg-name__zh rmg-name__mtr--osi").text(this._osiNames[0])).append($("<text>",{x:0,dy:12,class:"rmg-name__en rmg-name__mtr--osi"}).text(this._osiNames[1]))}get ungrpHTML(){return[...this.intTickHTML,this.origIntTickHTML,this.iconHTML,this.nameHTML,...this.intNameHTML,this.origIntNameHTML,this.osiNameHTML]}}class f extends N{get _nameDX(){return 3}get _tickRotation(){return 90}get _txtAnchor(){return"end"}get _intNameDX(){return-24}get _osiNameDX(){return 13}get _osiTxtAnchor(){return"start"}}class T extends N{get _nameDX(){return-3}get _tickRotation(){return-90}get _txtAnchor(){return"start"}get _intNameDX(){return 24}get _osiNameDX(){return-13}get _osiTxtAnchor(){return"end"}}class H extends u{constructor(t,s){super(t,s),[this._origIntCity,this._origIntLine,this._origIntColour,this._origIntFg,this._origIntNameZH,this._origIntNameEN]=s.transfer.info[0][2]}get origIntTickHTML(){var t=this.namePos?180:0,s=this._origIntColour,e=$("<use>",{"xlink:href":"#inttick_hk",stroke:s,transform:`translate(${this.x},${this.y})rotate(${t})`,class:"rmg-line rmg-line__mtr rmg-line__change"});return-1==this.state&&e.addClass("rmg-line__pass"),e}get origIntNameHTML(){var[t,s,e]=Object(i.h)([this._origIntNameZH,this._origIntNameEN],10,7),n=this.namePos?-37.703125-13*(s-1)-7*(e-1):30.953125;return $("<g>",{"text-anchor":"middle",transform:`translate(${this.x},${this.y+n})`,class:`Name ${this._nameClass}`}).html(t[0])}get iconHTML(){var t=this.namePos?1:-1,s="lineend"==this.children[0]?1:-1;this.children[0];return $("<use>",{"xlink:href":"#osi22end_hk",transform:`translate(${this.x},${this.y})scale(${s},${t})`,class:[this.iconClass,this.osiClass].join(" ")})}get _tickRotation(){return"lineend"==this.children[0]?-90:90}get _tickFlip(){return-1}get _dx(){return"lineend"==this.children[0]?41:-41}get _dy(){return this.namePos?18:-18}get _intNameDX(){return"lineend"==this.children[0]?65:-65}get _txtAnchor(){return"lineend"==this.children[0]?"start":"end"}get _osiDY(){return this.namePos?-26.6875:18.34375}get _osiTxtAnchor(){return"lineend"==this.children[0]?"start":"end"}get _osiDX(){return"lineend"==this.children[0]?-9:9}get ungrpHTML(){return[...this.intTickHTML,this.origIntTickHTML,this.iconHTML,this.nameHTML,...this.intNameHTML,this.origIntNameHTML,this.osiNameHTML]}}e.d(s,"RMGLineHK",(function(){return M}));class M extends n.a{constructor(t){super(t),this._txtFlip=t.txt_flip,this._charForm=t.char_form,this._destLegacy=t.dest_legacy}_initStnInstance(t,s){switch(s.transfer.type){case"int2":case"osi21":return new o(t,s);case"int3":case"osi31":return"l"===s.transfer.tick_direc?new m(t,s):new l(t,s);case"osi11":return"l"===s.transfer.tick_direc?new g(t,s):new d(t,s);case"osi12":case"osi13":return"l"===s.transfer.tick_direc?new p(t,s):new x(t,s);case"osi22":return"linestart"===s.parents[0]||"lineend"===s.children[0]?new H(t,s):"l"===s.transfer.tick_direc?new f(t,s):new T(t,s);default:return new h(t,s)}}_updateStnInstance(t){super._updateStnInstance(t),this.stations[t].namePos=this._txtFlip?!this._stnNamePos(t):this._stnNamePos(t)}set svgDestWidth(t){super.svgDestWidth=t,this.loadFonts()}set svgWidth(t){super.svgWidth=t,this.loadFonts(),this.updateStnNameBg()}set padding(t){super.padding=t,this.loadFonts(),this.updateStnNameBg()}set branchSpacing(t){super.branchSpacing=t,this.loadFonts(),this.updateStnNameBg()}set txtFlip(t){this._txtFlip=t,Object(i.k)("txt_flip",t);for(let[t,s]of Object.entries(this.stations))["linestart","lineend"].includes(t)||(s.namePos=this._txtFlip?!this._stnNamePos(t):this._stnNamePos(t));$("#stn_icons").empty(),this.drawStns(),this.loadFonts(),this.updateStnNameBg()}set direction(t){super.direction=t,this.loadFonts()}set charForm(t){this._charForm=t,Object(i.k)("char_form",t),$(".rmg-name__char-trad, .rmg-name__char-cn, .rmg-name__char-tw, .rmg-name__char-jp").removeClass("rmg-name__char-trad rmg-name__char-cn rmg-name__char-tw rmg-name__char-jp").addClass(`rmg-name__char-${t}`)}set lineNames(t){super.lineNames=t,this._destLegacy&&(this.drawDestInfo(),this.loadFonts())}set destLegacy(t){this._destLegacy=t,Object(i.k)("dest_legacy",t),this.drawDestInfo(),this.loadFonts()}set currentStnId(t){super.currentStnId=t,this.loadFonts(),this.updateStnNameBg()}_stnNamePos(t){if("linestart"===t)return!0;let s=this,e=this.criticalPath.nodes.indexOf(t)%2;if(-1===e){let e=this.stations[t].parents[0];return 2===this._stnOutdegree(e)?s._stnNamePos(e):!s._stnNamePos(e)}return 1===e}loadFonts(){$(".rmg-name__zh").addClass(`rmg-name__char-${this._charForm}`)}updateStnNameBg(){var t=Object(i.g)($(`#stn_icons > #${this._currentStnId} g.Name`)[0],"railmap");$("#current_bg").attr({x:t.x-3,width:t.width+6})}drawDestInfo(){$("#dest_name > #platform > text").text(this._platformNum);let t=this[this._direction+"ValidDests"],s="l"===this._direction?"start":"end";var[e,n]=[0,1].map(s=>t.map(t=>this.stations[t].name[s].replace(/\\/g," ")).join("/"));if(this._destLegacy){var[i,r]=this._lineNames;r+=" "}else var i=r="";$("#dest_name > g:last-child text").eq(0).text(`${i}å¾€${e}`),$("#dest_name > g:last-child text").eq(1).text(`${r}to ${n}`);var a=310+$("#dest_name > g:last-child")[0].getBoundingClientRect().width+45+50,h="l"==this._direction?1:-1,o=(this._svgDestWidth-h*a)/2,_=90*(1-h),m=o+285*h,l=m+120*h;$("#dest_name > use").attr("transform",`translate(${o},${.5*this._svgHeight-20})rotate(${_})`),$("#dest_name > #platform").attr("transform",`translate(${m},${.5*this._svgHeight-20})`),$("#dest_name > g:last-child").attr({transform:`translate(${l},${.5*this._svgHeight-45})`,"text-anchor":s})}_leftWideFactor(t){var s=0;let e=this.stations[t];return e instanceof m&&(s+=this._longInterval),e instanceof g&&(s+=this._longInterval),e instanceof p&&(s+=this._longInterval),e instanceof N&&(s+=this._longInterval),2==this._stnIndegree(t)&&(s+=this._longInterval/2),2==this._stnOutdegree(this.stations[t].parents[0])&&(s+=this._longInterval/2),s}_rightWideFactor(t){var s=0;let e=this.stations[t];return e instanceof l&&(s+=this._longInterval),e instanceof d&&(s+=this._longInterval),e instanceof x&&(s+=this._longInterval),e instanceof N&&(s+=this._longInterval),2==this._stnOutdegree(t)&&(s+=this._longInterval/2),2==this._stnIndegree(this.stations[t].children[0])&&(s+=this._longInterval/2),s}updateStnName(t,s,e){super.updateStnName(t,s,e),this.loadFonts(),t==this._currentStnId&&this.updateStnNameBg()}updateStnTransfer(t,s,e=null){super.updateStnTransfer(t,s,e),this.loadFonts(),this.updateStnNameBg()}addStn(t,s,e,n){let i=super.addStn(t,s,e,n);return this.loadFonts(),this.updateStnNameBg(),i}removeStn(t){return!!super.removeStn(t)&&(this.loadFonts(),this.updateStnNameBg(),!0)}updateBranchType(t,s,e){return!!super.updateBranchType(t,s,e)&&(this.loadFonts(),!0)}updateBranchFirst(t,s,e){return!!super.updateBranchFirst(t,s,e)&&(this.loadFonts(),!0)}updateBranchPos(t,s,e){return!!super.updateBranchPos(t,s,e)&&(this.loadFonts(),!0)}static initSVG(t){super.initSVG(t),t.loadFonts(),t.updateStnNameBg()}}}}]);