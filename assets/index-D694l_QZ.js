import{j as t}from"./chakra-CXrhlirJ.js";import{a as g}from"./react-Caefwd5V.js";import{aS as x,u as c}from"./index-BCLSi9Wm.js";import{S as f}from"./svg-wrapper-DO1Iqw6o.js";const _=x.Destination;function W(){const{canvasScale:r}=c(n=>n.app),{svgWidth:a,svg_height:e,theme:s}=c(n=>n.param),i=a[_];return t.jsxs(f,{type:_,svgWidth:i,svgHeight:e,canvasScale:r,theme:s,children:[t.jsx(N,{}),t.jsx(R,{})]})}const N=g.memo(function(){return t.jsx("defs",{children:t.jsx("marker",{id:"slope",viewBox:"-1.5 0 3 1.5",refY:.5,children:t.jsx("path",{d:"M0,0L1,1H-1z",fill:"var(--rmg-theme-colour)"})})})}),R=()=>{var m;const{routes:r}=c(o=>o.helper),{current_stn_idx:a,direction:e,stn_list:s}=c(o=>o.param),l=(m=((o,d,p)=>[...new Set(o.filter(h=>h.includes(p)).map(h=>{const u=h.filter(v=>!["linestart","lineend"].includes(v));return d==="l"?u[0]:u.reverse()[0]}))])(r,e,a).map(o=>[s[o].localisedName.zh,s[o].localisedName.en].filter(d=>d!==void 0).map(d=>d.replace("\\",""))).at(0))!=null?m:["",""];return t.jsx(H,{dest_name:l})},H=r=>{const{dest_name:a}=r,{direction:e,svgWidth:s,svg_height:i,theme:n}=c(l=>l.param);return t.jsxs("g",{transform:"translate(0,".concat(i-300,")"),children:[t.jsx("path",{stroke:n[2],strokeWidth:12,d:e==="l"?"M".concat(s.destination-24,",16 H 36"):"M24,16 H ".concat(s.destination-36),transform:"translate(0,220)",markerEnd:"url(#slope)"}),t.jsx(b,{dest_name:a})]})},b=r=>{const{dest_name:a}=r,{direction:e,svgWidth:s}=c(u=>u.param),i=g.useRef(null),n=g.useRef(null),[l,m]=g.useState(0);g.useEffect(()=>{if(i.current&&n.current){const u=Math.max(i.current.getBBox().width,n.current.getBBox().width);m(u)}},[...a]);const o=24,h=l+o+20+128;return t.jsxs("g",{transform:"translate(0,145)",children:[t.jsx("g",{transform:"translate(".concat(e==="l"?s.destination-h:h,",20)"),children:t.jsx("path",{d:"M60,60L0,0L60-60H100L55-15H160V15H55L100,60z",fill:"black",transform:"rotate(".concat(e==="l"?0:180,")scale(0.8)")})}),t.jsx("g",{ref:i,transform:"translate(".concat(e==="l"?s.destination-o:o,",25)"),textAnchor:e==="l"?"end":"start",children:t.jsx("text",{className:"rmg-name__zh rmg-outline",fontSize:70,dy:7,children:"往"+a[0]})}),t.jsx("g",{ref:n,transform:"translate(".concat(e==="l"?s.destination-o:o,",25)"),children:t.jsx("text",{className:"rmg-name__en rmg-outline",fontSize:25,dx:e==="l"?-l:0,dy:40,children:"To "+a[1]})})]})},j=x.Platform,y=()=>{const{canvasScale:r}=c(n=>n.app),{svgWidth:a,svg_height:e,theme:s}=c(n=>n.param),i=a[j];return t.jsx(f,{type:j,svgWidth:i,svgHeight:e,canvasScale:r,theme:s,children:t.jsx(z,{})})},z=()=>{const{svgWidth:r,svg_height:a,platform_num:e}=c(i=>i.param),s=r.platform/2;return t.jsxs("g",{transform:"translate(".concat(s,",").concat(a-140,")"),children:[t.jsx("text",{className:"rmg-name__en rmg-outline",dominantBaseline:"central",fontSize:120,textAnchor:"end",children:e}),t.jsx("text",{className:"rmg-name__zh rmg-outline",fontSize:50,x:10,dy:10,children:"站台"}),t.jsx("text",{className:"rmg-name__zh rmg-outline",fontSize:30,x:10,dy:50,children:"Platform"})]})},S=x.RunIn,D=()=>{const{canvasScale:r}=c(l=>l.app),{svgWidth:a,svg_height:e,theme:s}=c(l=>l.param),i=a[S],n=e-300;return t.jsxs(f,{type:S,svgWidth:i,svgHeight:e,canvasScale:r,theme:s,children:[t.jsx(w,{}),t.jsx("g",{transform:"translate(0,".concat(n,")"),children:t.jsx(A,{})})]})},w=g.memo(function(){return t.jsx("defs",{children:t.jsx("marker",{id:"slope",viewBox:"-1.5 0 3 1.5",refY:.5,children:t.jsx("path",{d:"M0,0L1,1H-1z",fill:"var(--rmg-theme-colour)"})})})}),A=()=>{const{svgWidth:r,stn_list:a,current_stn_idx:e}=c(o=>o.param),{localisedName:s,character_spacing:i}=a[e],{zh:n="",en:l=""}=s,m=r.runin/2;return t.jsxs("g",{transform:"translate(".concat(m,",160)"),textAnchor:"middle",children:[t.jsx("text",{className:"rmg-name__zh rmg-outline",fontSize:112,dx:i/2,letterSpacing:i,children:n.replace("\\","")}),t.jsx("text",{className:"rmg-name__en rmg-outline",fontSize:36,dy:75,children:l.replace("\\","")})]})},T={destination:t.jsx(W,{}),runin:t.jsx(D,{}),platform:t.jsx(y,{})};export{T as default};
