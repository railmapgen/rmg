import{j as t}from"./chakra-jT2-teuD.js";import{a as d}from"./react-BNX4K-US.js";import{u as m,aY as x}from"./index-HyGScCuj.js";import{S as f}from"./svg-wrapper-h0h12Ph0.js";const _=x.Destination;function v(){const{canvasScale:r}=m(n=>n.app),{svgWidth:a,svg_height:e,theme:s}=m(n=>n.param),i=a[_];return t.jsxs(f,{type:_,svgWidth:i,svgHeight:e,canvasScale:r,theme:s,children:[t.jsx(W,{}),t.jsx(N,{})]})}const W=d.memo(function(){return t.jsx("defs",{children:t.jsx("marker",{id:"slope",viewBox:"-1.5 0 3 1.5",refY:.5,children:t.jsx("path",{d:"M0,0L1,1H-1z",fill:"var(--rmg-theme-colour)"})})})}),N=()=>{const{routes:r}=m(c=>c.helper),{current_stn_idx:a,direction:e,stn_list:s}=m(c=>c.param),l=((c,o,p)=>[...new Set(c.filter(g=>g.includes(p)).map(g=>{const h=g.filter(u=>!["linestart","lineend"].includes(u));return o==="l"?h[0]:h.reverse()[0]}))])(r,e,a).map(c=>[s[c].localisedName.zh,s[c].localisedName.en].filter(o=>o!==void 0).map(o=>o.replace("\\",""))).at(0)??["",""];return t.jsx(R,{dest_name:l})},R=r=>{const{dest_name:a}=r,{direction:e,svgWidth:s,svg_height:i,theme:n}=m(l=>l.param);return t.jsxs("g",{transform:`translate(0,${i-300})`,children:[t.jsx("path",{stroke:n[2],strokeWidth:12,d:e==="l"?`M${s.destination-24},16 H 36`:`M24,16 H ${s.destination-36}`,transform:"translate(0,220)",markerEnd:"url(#slope)"}),t.jsx(H,{dest_name:a})]})},H=r=>{const{dest_name:a}=r,{direction:e,svgWidth:s}=m(u=>u.param),i=d.useRef(null),n=d.useRef(null),[l,c]=d.useState(0);d.useEffect(()=>{if(i.current&&n.current){const u=Math.max(i.current.getBBox().width,n.current.getBBox().width);c(u)}},[...a]);const o=24,h=l+o+20+128;return t.jsxs("g",{transform:"translate(0,145)",children:[t.jsx("g",{transform:`translate(${e==="l"?s.destination-h:h},20)`,children:t.jsx("path",{d:"M60,60L0,0L60-60H100L55-15H160V15H55L100,60z",fill:"black",transform:`rotate(${e==="l"?0:180})scale(0.8)`})}),t.jsx("g",{ref:i,transform:`translate(${e==="l"?s.destination-o:o},25)`,textAnchor:e==="l"?"end":"start",children:t.jsx("text",{className:"rmg-name__zh rmg-outline",fontSize:70,dy:7,children:"往"+a[0]})}),t.jsx("g",{ref:n,transform:`translate(${e==="l"?s.destination-o:o},25)`,children:t.jsx("text",{className:"rmg-name__en rmg-outline",fontSize:25,dx:e==="l"?-l:0,dy:40,children:"To "+a[1]})})]})},j=x.Platform,b=()=>{const{canvasScale:r}=m(n=>n.app),{svgWidth:a,svg_height:e,theme:s}=m(n=>n.param),i=a[j];return t.jsx(f,{type:j,svgWidth:i,svgHeight:e,canvasScale:r,theme:s,children:t.jsx(y,{})})},y=()=>{const{svgWidth:r,svg_height:a,platform_num:e}=m(i=>i.param),s=r.platform/2;return t.jsxs("g",{transform:`translate(${s},${a-140})`,children:[t.jsx("text",{className:"rmg-name__en rmg-outline",dominantBaseline:"central",fontSize:120,textAnchor:"end",children:e}),t.jsx("text",{className:"rmg-name__zh rmg-outline",fontSize:50,x:10,dy:10,children:"站台"}),t.jsx("text",{className:"rmg-name__zh rmg-outline",fontSize:30,x:10,dy:50,children:"Platform"})]})},S=x.RunIn,z=()=>{const{canvasScale:r}=m(l=>l.app),{svgWidth:a,svg_height:e,theme:s}=m(l=>l.param),i=a[S],n=e-300;return t.jsxs(f,{type:S,svgWidth:i,svgHeight:e,canvasScale:r,theme:s,children:[t.jsx(D,{}),t.jsx("g",{transform:`translate(0,${n})`,children:t.jsx(w,{})})]})},D=d.memo(function(){return t.jsx("defs",{children:t.jsx("marker",{id:"slope",viewBox:"-1.5 0 3 1.5",refY:.5,children:t.jsx("path",{d:"M0,0L1,1H-1z",fill:"var(--rmg-theme-colour)"})})})}),w=()=>{const{svgWidth:r,stn_list:a,current_stn_idx:e}=m(o=>o.param),{localisedName:s,character_spacing:i}=a[e],{zh:n="",en:l=""}=s,c=r.runin/2;return t.jsxs("g",{transform:`translate(${c},160)`,textAnchor:"middle",children:[t.jsx("text",{className:"rmg-name__zh rmg-outline",fontSize:112,dx:i/2,letterSpacing:i,children:n.replace("\\","")}),t.jsx("text",{className:"rmg-name__en rmg-outline",fontSize:36,dy:75,children:l.replace("\\","")})]})},I={destination:t.jsx(v,{}),runin:t.jsx(z,{}),platform:t.jsx(b,{})};export{I as default};
