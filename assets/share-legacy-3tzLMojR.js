System.register(["./chakra-legacy-rsWUbD51.js","./index-legacy-L_o7clcm.js"],(function(t,e){"use strict";var s,n;return{setters:[t=>{s=t.j},t=>{n=t.S}],execute:function(){t("S",(function(t){const{type:e,svgWidth:n,svgHeight:i,canvasScale:r,theme:h,children:l}=t;return s.jsxs("svg",{id:e,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",height:i*r,viewBox:`0 0 ${n} ${i}`,colorInterpolationFilters:"sRGB",style:{"--rmg-svg-width":n+"px","--rmg-svg-height":i+"px","--rmg-theme-colour":h[2],"--rmg-theme-fg":h[3]},children:[s.jsx("rect",{id:"canvas-bg",fill:"white",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}}),l,s.jsx("rect",{id:"canvas-border",fill:"none",strokeWidth:3,stroke:"none",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}})]})})),t("a",((t,e,s)=>Object.keys(t).reduce(((n,i)=>({...n,[i]:t[i].children.reduce(((n,r)=>({...n,[r]:1+e(t,r)+s(t,i)})),{})})),{})));const e=t("c",((t,s,n)=>{if(t===s)return{len:0,nodes:[t]};const i=[],r=[];Object.keys(n[t]).forEach((h=>{const l=e(h,s,n);l.len<0||(i.push(n[t][h]+l.len),l.nodes.unshift(t),r.push(l.nodes))}));const h=Math.max(...i);return{len:h,nodes:r[i.indexOf(h)]}})),i=(t("g",((t,s,n)=>{const i=e("linestart","lineend",s);if(i.nodes.includes(t))return e(i.nodes[1],t,s).len;{const r=n.filter((e=>e.includes(t)))[0];let h=t;for(;!i.nodes.includes(h);)h=r[r.indexOf(h)-1];let l=t;for(;!i.nodes.includes(l);)l=r[r.indexOf(l)+1];const a="linestart"===h,c=[];return a||"lineend"===l?a?(c[0]=0,c[1]=e(i.nodes[1],l,s).len,c[2]=e(r[1],t,s).len,c[3]=e(t,l,s).len):(c[0]=e(i.nodes[1],h,s).len,c[1]=e(h,i.nodes.slice(-2)[0],s).len,c[2]=e(h,t,s).len,c[3]=e(t,r.slice(-2)[0],s).len):(c[0]=e(i.nodes[1],h,s).len,c[1]=e(h,l,s).len,c[2]=e(h,t,s).len,c[3]=e(t,l,s).len),c[0]+c[2]*c[1]/(c[2]+c[3])}})),(t,e,s)=>{for(const n of s){const s=n.indexOf(t),i=n.indexOf(e);if(-1!==i&&i<s)return!0}return!1}),r=(t,e,s)=>{for(const n of s){const s=n.indexOf(t),i=n.indexOf(e);if(-1!==s&&s<i)return!0}return!1};t("b",((t,e,s)=>(console.log("computing stations' states"),[...new Set([].concat(...e))].reduce(((h,l)=>({...h,[l]:l===t?0:(s===n.right?r(t,l,e):i(t,l,e))?1:-1})),{})))),t("e",class{constructor(t){this.yShares={},this.xShares={},this.namePoss={},this.stnList={},this.criticalPath={},this.leftWideFactor=t=>0,this.rightWideFactor=t=>0,this.pathTurnParams=t=>{const e=35-17.5*Math.sqrt(3),s=t-2*e;return{tr:35,dx_a:17.5,dy_a:e,dx_l:s*Math.sqrt(3),dy_l:s}},this.pathTurnSE=t=>{const{tr:e,dx_a:s,dy_a:n,dx_l:i,dy_l:r}=this.pathTurnParams(t);return`a ${e},${e} 0 0,1 ${s},${n} l ${i},${r} a ${e},${e} 0 0,0 ${s},${n}`},this.pathTurnNE=t=>{const{tr:e,dx_a:s,dy_a:n,dx_l:i,dy_l:r}=this.pathTurnParams(t);return`a ${e},${e} 0 0,0 ${s},${-n} l ${i},${-r} a ${e},${e} 0 0,1 ${s},${-n}`},this.stnList=t.stnList,this.criticalPath=t.criticalPath}getYShare(t,e){if(t in this.yShares)return this.yShares[t];if(["linestart","lineend"].includes(t)||this.stnList[t].parents.length>1||this.stnList[t].children.length>1)return this.yShares[t]=0,0;const s=this.stnList[t].parents[0];if(s){if(1===this.stnList[s].children.length){const e=this.getYShare(s);return this.yShares[t]=e,e}{const e=0===this.stnList[s].children.indexOf(t)?1:-1;return this.yShares[t]=e,e}}return this.yShares[t]=0,0}static getYShares(t,e){console.log("computing y shares");const s=new this({stnList:t});return Object.keys(t).forEach((t=>{["linestart","lineend"].includes(t)||t in s.yShares||s.getYShare(t,e)})),s.yShares}_linePath(t,e,s,n,i,r,h,l){let[a,c,o]=[];const d=[],{dx_a:u,dx_l:g}=this.pathTurnParams(r),f=u+g/2,$=(e[1]-e[0])/h.len*2,p=((e[1]-e[0])/h.len-2*f)/2;return p+$<0&&console.warn(`SVG width too small! ${p+$}`),t.forEach((e=>{const h=n[e],u=i[e];if(!c&&0!==c)return[a,o,c]=[e,h,u],void(1===t.length?d.push(`M ${h},${u}`):s[0].includes(e)?s[0].includes(t[1])?d.push(`M ${h},${u}`):(n[t[1]]>0&&d.push(`M ${h},${u+l}`),i[t[1]]<0&&d.push(`M ${h},${u-l}`)):d.push(`M ${h},${u}`));u>c?(d.push(0===u?"h "+(h-o-$*this.leftWideFactor(e)-p-2*f):`h ${$*this.rightWideFactor(a)+p}`),d.push(this.pathTurnSE(r))):u<c&&(d.push(0===u?"h "+(h-o-$*this.leftWideFactor(e)-p-2*f):`h ${$*this.rightWideFactor(a)+p}`),d.push(this.pathTurnNE(r))),d.push(`H ${h}`),[a,o,c]=[e,h,u]})),d.join(" ").replace(/( H ([\d.]+))+/g," H $2")}}),t("d",((t,e)=>{let s=(t=t.filter((t=>!["linestart","lineend"].includes(t)))).filter((t=>e[t]>=0)),n=t.filter((t=>e[t]<=0));return 1===s.length&&(n=t),0===s.filter((t=>-1!==n.indexOf(t))).length&&s.length&&(n[0]===t[0]?n.push(s[0]):s[0]===t[0]&&s[s.length-1]===t[t.length-1]&&n.length?(n=t,s=[]):n.unshift(s[s.length-1])),{main:s,pass:n}}))}}}));
