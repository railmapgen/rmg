import{j as a}from"./chakra-CXrhlirJ.js";import{a as u}from"./react-Caefwd5V.js";import{h as D,aW as A,u as b,m as Oe,S as N,aP as B,P}from"./index-BNw4ulhB.js";import{a as Be,c as w,b as $e,d as Ce}from"./share-CBpk_WHv.js";import{S as pe}from"./svg-wrapper-DO1Iqw6o.js";import{i as Ee}from"./param-selector-Dz1wbauC.js";function Pe(t){const{num:e,inStrip:s,...n}=t;return a.jsxs("g",{textAnchor:"middle",fill:s?D.black:"var(--rmg-theme-fg)",...n,children:[a.jsx("rect",{height:40,width:40,rx:4,x:-20,fill:s?"#fff":"var(--rmg-theme-colour)"}),a.jsx("text",{className:"rmg-name__en",fontSize:20,dy:12,children:e}),a.jsx("text",{className:"rmg-name__zh",fontSize:12,dy:26,children:"屏蔽门"}),a.jsx("text",{className:"rmg-name__en",fontSize:6.5,dy:36,children:"Screen Door"})]})}const _e=t=>{const e=(r=>{switch(r){case"gz28":case"gz2otis":case"gz6":case"gzgf":return 60;case"gz1":case"gz3":return 40;case"gz4":case"gz5":case"gz1421":return 20;default:return 0}})(t.variant),s=u.useMemo(()=>{switch(t.variant){case"gz1":return a.jsx("circle",{cy:-58,r:16,fill:"red"});case"gz28":case"gz2otis":return a.jsx("ellipse",{cy:-30,rx:24,ry:12,fill:"orange"});case"gz3":return a.jsx("rect",{x:-15,y:-55,height:30,width:30,fill:"red"});case"gz6":return a.jsx("ellipse",{cy:-30,rx:24,ry:12,fill:"white"});case"gz1421":return a.jsx("ellipse",{cy:-38,rx:24,ry:12,fill:"orange"});case"gz5":return a.jsx("rect",{x:-30,y:-70,height:30,width:60,fill:"orange"});case"gz4":return a.jsx("rect",{x:-50,y:-50,height:25,width:100,fill:"whitesmoke"});case"gzgf":return a.jsx("rect",{x:-30,y:-58,height:30,width:60,fill:"orange"});default:return a.jsx(a.Fragment,{})}},[t.variant]);return a.jsxs("g",{transform:"translate(0,".concat(t.variant==="gz4"?-20:0,")"),children:[a.jsx("rect",{id:"strip_gz",style:{"--height":"".concat(e,"px")}}),a.jsx("g",{style:{transform:"translate(calc(var(--rmg-svg-width) / 2),var(--rmg-svg-height))"},children:t.isShowLight&&s}),t.isShowPSD!==!1&&a.jsx(ke,{...t})]})},ke=u.memo(function(e){const s=["gz28","gz2otis","gz6","gzgf"].includes(e.variant),n=(r=>{switch(r){case"gz1":case"gz3":return"82px";case"gz4":return"65px";case"gz5":return"80px";case"gz1421":return"62px";default:return"58px"}})(e.variant);return a.jsx(Pe,{num:e.isShowPSD,inStrip:s,style:{"--psd-dy":n,transform:"translate(var(--translate-x), var(--translate-y))","--translate-x":"calc(var(--rmg-svg-width) / 2 + 80px)","--translate-y":"calc(var(--rmg-svg-height) - var(--psd-dy, 58px))"}})},(t,e)=>t.variant===e.variant&&t.isShowPSD===e.isShowPSD);var k=1.3,X=18.5,Ie=X+k,F=X*2+k;var Z=45,C=Z-3,je=function(t,e){var s=[t,e].map(function(n){return n.match(/^(\w+).+$/)});if(s[0]&&s[1]&&s[0][1]===s[1][1])return s[0][1]},ae=function(t){var e=t.match(/^(\d+)\D+$/);return e==null?void 0:e[1]},q=function(){return q=Object.assign||function(t){for(var e,s=1,n=arguments.length;s<n;s++){e=arguments[s];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},q.apply(this,arguments)},Re=function(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(s[n[r]]=t[n[r]]);return s};function U(t){var e=t.customWidth,s=Re(t,["customWidth"]),n=(e!=null?e:Z)-Z;return a.jsx("rect",q({x:-22.5-n/2,height:24,width:e!=null?e:Z,rx:4.5},s,{"data-testid":"intBox"}))}var De=function(t,e){var s=typeof Symbol=="function"&&t[Symbol.iterator];if(!s)return t;var n=s.call(t),r,i=[],o;try{for(;(e===void 0||e-- >0)&&!(r=n.next()).done;)i.push(r.value)}catch(c){o={error:c}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(o)throw o.error}}return i},Te=function(t,e){var s=ae(t);if(s)return{isDigit:!0,spanningPart:s};var n=je(t,e);return n?{isDigit:!1,spanningPart:n}:{isDigit:!1,spanningPart:""}};function oe(t){var e=t.zhName,s=t.enName,n=t.foregroundColour,r=t.backgroundColour,i=t.zhClassName,o=t.enClassName,c=t.passed,m=Te(e,s),l=m.isDigit,f=m.spanningPart,d=u.useRef(null),h=De(u.useState({x:0,height:0,width:0}),2),g=h[0],x=h[1];u.useEffect(function(){d.current&&x(d.current.getBBox())},[e,s]);var y=C/Math.max(C,g.width),v=(-g.x-g.width/2)*y,j=g.height*(1-y)/2;return a.jsxs("g",{textAnchor:"middle",fill:c?D.white:n,children:[a.jsx(U,{fill:c?"#aaa":r}),a.jsx("g",{ref:d,transform:"translate(".concat(v,",").concat(j,")scale(").concat(y,")"),children:a.jsxs("text",{className:i,fontSize:21,x:-1,y:12,textAnchor:"end",dominantBaseline:"central",children:[f,a.jsx("tspan",{className:i,fontSize:10,x:0,dy:-4,textAnchor:"start",dominantBaseline:"central",children:e.slice(f.length).trim()}),a.jsx("tspan",{className:o,fontSize:6.5,letterSpacing:-.1,x:0,dy:10,textAnchor:"start",dominantBaseline:"middle",children:l?s:s.slice(f.length).trim()})]})})]})}var le=function(t,e){var s=typeof Symbol=="function"&&t[Symbol.iterator];if(!s)return t;var n=s.call(t),r,i=[],o;try{for(;(e===void 0||e-- >0)&&!(r=n.next()).done;)i.push(r.value)}catch(c){o={error:c}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(o)throw o.error}}return i};function Ae(t){var e,s=t.zhName,n=t.enName,r=t.foregroundColour,i=t.backgroundColour,o=t.zhClassName,c=t.enClassName,m=t.passed,l=(e=ae(s))!==null&&e!==void 0?e:"",f=u.useRef(null),d=u.useRef(null),h=le(u.useState({width:0}),2),g=h[0],x=h[1],y=le(u.useState({width:0}),2),v=y[0],j=y[1];u.useEffect(function(){f.current&&x(f.current.getBBox()),d.current&&j(d.current.getBBox())},[s,n]);var p=C/Math.max(C,g.width),_=C/Math.max(C,v.width),S={nameZh:{y:7.3+13.5*(1-p)*p/2},nameEn:{y:19.5-9*(1-_)*_/2}};return a.jsxs("g",{textAnchor:"middle",fill:m?D.white:r,children:[a.jsx(U,{fill:m?"#aaa":i}),a.jsxs("text",{ref:f,className:o,fontSize:12,transform:"translate(0,".concat(S.nameZh.y,")scale(").concat(p,")"),dominantBaseline:"central",children:[a.jsx("tspan",{fontSize:16,dy:.7,dominantBaseline:"central",children:l}),a.jsx("tspan",{dy:-.7,dominantBaseline:"central",children:s.slice(l.length)})]}),a.jsx("text",{ref:d,className:c,fontSize:8,transform:"translate(0,".concat(S.nameEn.y,")scale(").concat(_,")"),dominantBaseline:"middle",children:n})]})}var We=function(t,e){var s=typeof Symbol=="function"&&t[Symbol.iterator];if(!s)return t;var n=s.call(t),r,i=[],o;try{for(;(e===void 0||e-- >0)&&!(r=n.next()).done;)i.push(r.value)}catch(c){o={error:c}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(o)throw o.error}}return i};function Le(t){var e=t.zhName,s=t.enName,n=t.foregroundColour,r=t.backgroundColour,i=t.zhClassName,o=t.enClassName,c=t.passed,m=u.useRef(null),l=We(u.useState({width:0}),2),f=l[0],d=l[1];u.useEffect(function(){m.current&&d(m.current.getBBox())},[e,s]);var h=Math.max(45,f.width+4);return a.jsxs("g",{textAnchor:"middle",fill:c?D.white:n,children:[a.jsx(U,{customWidth:h,fill:c?"#aaa":r}),a.jsxs("g",{ref:m,children:[a.jsx("text",{className:i,fontSize:8.5,y:8,dominantBaseline:"central",children:e}),a.jsx("text",{className:o,fontSize:5.5,y:18,dominantBaseline:"middle",children:s})]})]})}var ce=function(t,e){var s=typeof Symbol=="function"&&t[Symbol.iterator];if(!s)return t;var n=s.call(t),r,i=[],o;try{for(;(e===void 0||e-- >0)&&!(r=n.next()).done;)i.push(r.value)}catch(c){o={error:c}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(o)throw o.error}}return i};function He(t){var e=t.zhName,s=t.enName,n=t.foregroundColour,r=t.backgroundColour,i=t.zhClassName,o=t.enClassName,c=t.passed,m=u.useRef(null),l=u.useRef(null),f=ce(u.useState({width:0}),2),d=f[0],h=f[1],g=ce(u.useState({width:0}),2),x=g[0],y=g[1];u.useEffect(function(){m.current&&h(m.current.getBBox()),l.current&&y(l.current.getBBox())},[e,s]);var v=C/Math.max(C,d.width),j=C/Math.max(C,x.width),p={nameZh:{y:7.3+13.5*(1-v)*v/2},nameEn:{y:19.5-9*(1-j)*j/2}};return a.jsxs("g",{textAnchor:"middle",fill:c?D.white:n,children:[a.jsx(U,{fill:c?"#aaa":r}),a.jsx("text",{ref:m,className:i,fontSize:12,transform:"translate(0,".concat(p.nameZh.y,")scale(").concat(v,")"),dominantBaseline:"central",children:e}),a.jsx("text",{ref:l,className:o,fontSize:8,transform:"translate(0,".concat(p.nameEn.y,")scale(").concat(j,")"),dominantBaseline:"middle",children:s})]})}var R=function(){return R=Object.assign||function(t){for(var e,s=1,n=arguments.length;s<n;s++){e=arguments[s];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},R.apply(this,arguments)};const Se=u.memo(function(e){var s=e.zhName,n=e.enName,r=e.spanDigits,i=Me(s,n);switch(i){case 1:return r?a.jsx(oe,R({},e)):a.jsx(Ae,R({},e));case 2:return a.jsx(oe,R({},e));default:return s.length>=5?a.jsx(Le,R({},e)):a.jsx(He,R({},e))}});var Me=function(t,e){var s=ae(t);if(s!==void 0)return 1;var n=je(t,e);return n!==void 0?2:3},K=function(){return K=Object.assign||function(t){for(var e,s=1,n=arguments.length;s<n;s++){e=arguments[s];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},K.apply(this,arguments)},Ze=function(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(s[n[r]]=t[n[r]]);return s},W=5,L=5.625,me=X-W,ue=X-2*L;const Ne=u.memo(function(e){var s=e.stroke,n=e.filled,r=Ze(e,["stroke","filled"]),i="M0,9.25 V-9.25 H-".concat(me," l-").concat(W,",").concat(L," v").concat(ue," l").concat(W,",").concat(L," H").concat(me," l").concat(W,",-").concat(L," v-").concat(ue," l-").concat(W,",-").concat(L," H0");return a.jsx("path",K({d:i,fill:n?s:"#fff",strokeWidth:k,stroke:s},r))});var Q=function(){return Q=Object.assign||function(t){for(var e,s=1,n=arguments.length;s<n;s++){e=arguments[s];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},Q.apply(this,arguments)},Fe=function(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(s[n[r]]=t[n[r]]);return s};const we=u.memo(function(e){var s=e.stroke,n=e.filled,r=Fe(e,["stroke","filled"]),i="M0,9.25 V-9.25 H-9.25 a9.25,9.25 0 0,0 0,18.5 h18.5 a9.25,9.25 0 0,0 0,-18.5 H0";return a.jsx("path",Q({d:i,fill:n?s:"#fff",strokeWidth:k,stroke:s},r))});var Ge={updateId:0,update:function(){}},Xe=u.createContext(Ge),ee=function(){return ee=Object.assign||function(t){for(var e,s=1,n=arguments.length;s<n;s++){e=arguments[s];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},ee.apply(this,arguments)},Ue=function(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(s[n[r]]=t[n[r]]);return s},de=function(t,e){var s=typeof Symbol=="function"&&t[Symbol.iterator];if(!s)return t;var n=s.call(t),r,i=[],o;try{for(;(e===void 0||e-- >0)&&!(r=n.next()).done;)i.push(r.value)}catch(c){o={error:c}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(o)throw o.error}}return i},M=15,be=u.forwardRef(function(e,s){var n=e.Icon,r=e.lineNum,i=e.stnNum,o=e.strokeColour,c=e.passed,m=e.size,l=e.textClassName,f=Ue(e,["Icon","lineNum","stnNum","strokeColour","passed","size","textClassName"]),d=u.useContext(Xe).updateId,h=u.useRef(null),g=u.useRef(null),x=de(u.useState({width:0}),2),y=x[0],v=x[1],j=de(u.useState({width:0}),2),p=j[0],_=j[1];u.useEffect(function(){h.current&&v(h.current.getBBox()),g.current&&_(g.current.getBBox())},[r,i,d]);var S=M/Math.max(M,y.width),$=(r==null?void 0:r.length)===2&&(i==null?void 0:i.length)===2?S:M/Math.max(M,p.width),E=m==="sm"?"0.7":m==="lg"?"1.4":1;return a.jsx("g",ee({ref:s},f,{children:a.jsxs("g",{transform:"scale(".concat(E,")"),children:[a.jsx(n,{stroke:c?"#aaa":o,filled:!r&&!i}),(r||i)&&a.jsxs("g",{textAnchor:"middle",fontSize:13.5,fill:c?"#aaa":"#000",children:[a.jsx("g",{transform:"translate(-9.25,0)scale(".concat(S,")"),children:a.jsx("text",{ref:h,className:l,dominantBaseline:"central",x:.5,children:r})}),a.jsx("g",{transform:"translate(9.25,0)scale(".concat($,")"),children:a.jsx("text",{ref:g,className:l,dominantBaseline:"central",children:i})})]})]})}))}),te=function(){return te=Object.assign||function(t){for(var e,s=1,n=arguments.length;s<n;s++){e=arguments[s];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},te.apply(this,arguments)},Ve=u.forwardRef(function(e,s){return a.jsx(be,te({Icon:Ne},e,{ref:s}))}),ne=function(){return ne=Object.assign||function(t){for(var e,s=1,n=arguments.length;s<n;s++){e=arguments[s];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},ne.apply(this,arguments)},se=u.forwardRef(function(e,s){return a.jsx(be,ne({Icon:we},e,{ref:s}))}),re=function(){return re=Object.assign||function(t){for(var e,s=1,n=arguments.length;s<n;s++){e=arguments[s];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},re.apply(this,arguments)},Je=function(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(s[n[r]]=t[n[r]]);return s};function fe(t){var e=t.position,s=Je(t,["position"]),n=e==="right"?"rotate(180)":"rotate(0)";return a.jsx("circle",re({cx:-F*.4,cy:0,r:F/4,stroke:"#aaa",strokeWidth:k*1.75,fill:"white",strokeDasharray:"2.7 2.5",transform:n},s))}var G=function(){return G=Object.assign||function(t){for(var e,s=1,n=arguments.length;s<n;s++){e=arguments[s];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},G.apply(this,arguments)},he=function(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(s[n[r]]=t[n[r]]);return s},xe=function(t,e){var s=typeof Symbol=="function"&&t[Symbol.iterator];if(!s)return t;var n=s.call(t),r,i=[],o;try{for(;(e===void 0||e-- >0)&&!(r=n.next()).done;)i.push(r.value)}catch(c){o={error:c}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(o)throw o.error}}return i},V=function(t,e){return Array.from(Array(t).keys()).map(function(s){return(s-(t-1)/2)*e})},Ye=function(t,e,s){if(t<=0)return[];if(t===1)return[[0,0]];for(var n=e>t?t:e,r=F,i=Ie,o=V(n,r),c=Math.ceil(t/n),m=V(c,i),l=t%n,f=[],d=0;d<c;d++){var h=s?c-1:0;if(l===0||d!==h)for(var g=0;g<n;g++)f.push([o[g],m[d]]);else for(var x=V(l,r),g=0;g<l;g++)f.push([x[g],m[d]])}return f},ge=function(t){return t==="fmetro"?Ne:we},I=k*7,J=k*2.2;u.forwardRef(function(e,s){var n=e.stations,r=e.textClassName,i=e.columns,o=i===void 0?2:i,c=e.topHeavy,m=e.anchorAt,l=e.osiPosition,f=he(e,["stations","textClassName","columns","topHeavy","anchorAt","osiPosition"]),d=u.useMemo(function(){return Ye(n.length,o,c)},[n.length,o,c]),h=xe(u.useMemo(function(){if(m===void 0)return[0,0];if(m<0||m>=d.length)return console.warn("<InterchangeStation2024/>, anchor index ".concat(m," is out of bound")),[0,0];var p=xe(d[m],2),_=p[0],S=p[1];return[-_,-S]},[d,m]),2),g=h[0],x=h[1],y=u.useRef(null),v=u.useRef([]);u.useEffect(function(){v.current=v.current.slice(0,n.length)},[n.length]);var j=n.length===2&&o===1&&!!l;return u.useImperativeHandle(s,function(){return{target:y.current,children:v.current,getCoordinates:function(){return d},getCorrectedBBox:function(){var p,_,S=(_=(p=y.current)===null||p===void 0?void 0:p.getBBox())!==null&&_!==void 0?_:{x:0,y:0,width:0,height:0};return S.y-=I/2,S.height+=I,j?(l==="left"?S.x-=J/2:S.x-=I/2,S.width+=J/2+I/2):(S.x-=I/2,S.width+=I),S},getTranslate:function(){return[g,x]}}},[d,g,x,y.current,v.current,l]),a.jsxs("g",G({ref:y,transform:"translate(".concat(g,",").concat(x,")")},f,{children:[n.map(function(p,_){var S=p.style,$=ge(S);return a.jsx($,{stroke:"#aaa",filled:!0,strokeWidth:I,transform:"translate(".concat(d[_][0],",").concat(d[_][1],")")},_)}),j&&a.jsx(fe,{position:l,r:F/2.9,strokeWidth:J,strokeDasharray:void 0}),n.map(function(p,_){var S=p.style,$=ge(S);return a.jsx($,{stroke:"white",filled:!0,strokeWidth:k*2.6,transform:"translate(".concat(d[_][0],",").concat(d[_][1],")")},_)}),j&&a.jsx(fe,{position:l}),n.length&&a.jsx("rect",{fill:"white",x:-12,y:d[0][1],width:24,height:-d[0][1]*2}),n.map(function(p,_){var S=p.style,$=he(p,["style"]),E=S==="fmetro"?Ve:se;return a.jsx(E,G({ref:function(T){return v.current[_]=T},transform:"translate(".concat(d[_][0],",").concat(d[_][1],")"),textClassName:r},$),_)})]}))});const qe=u.memo(function(e){const{stnName:s,onUpdate:n}=e,{zh:r="",en:i=""}=s,o=u.useRef(null);return u.useEffect(()=>{o.current&&n&&n(o.current.getBBox())},[s.toString()]),a.jsxs("g",{ref:o,children:[a.jsx("text",{className:"rmg-name__zh",fontSize:18,children:r}),a.jsx("g",{fontSize:10.5,children:i.split("\\").map((c,m)=>a.jsx("text",{className:"rmg-name__en",dy:16+m*11,children:c},m))})]})},(t,e)=>JSON.stringify(t.stnName)===JSON.stringify(e.stnName));function Ke(t){const{stnName:e,onUpdate:s,passed:n,...r}=t,{zh:i="",en:o=""}=e,c=u.useRef(null),[m,l]=u.useState({x:0,width:0});return u.useEffect(()=>{if(c.current){const f=c.current.getBBox();l(f),s==null||s(f)}},[e.toString()]),!i&&!o?a.jsx(a.Fragment,{}):a.jsxs("g",{fill:n?"#aaa":"#000",...r,children:[a.jsxs("g",{transform:"translate(0,3)",fontSize:18,children:[a.jsx("text",{textAnchor:"end",x:m.x-3,className:"rmg-name__zh",children:"("}),a.jsx("text",{textAnchor:"start",x:m.width+m.x+3,className:"rmg-name__zh",children:")"})]}),a.jsxs("g",{ref:c,textAnchor:"middle",children:[a.jsx("text",{className:"rmg-name__zh",fontSize:13,children:i}),a.jsx("text",{dy:10,className:"rmg-name__en",fontSize:6.5,children:o})]})]})}function Qe(t){const{passed:e,...s}=t;return a.jsxs("g",{textAnchor:"middle",fill:e?"#aaa":"var(--rmg-theme-colour)",...s,children:[a.jsx("text",{className:"rmg-name__zh",fontSize:13,children:"快车停靠站"}),a.jsx("text",{dy:10,className:"rmg-name__en",fontSize:6.5,children:"Express Station"})]})}function et(t){var g,x,y;const{primaryName:e,secondaryName:s,stationState:n,flipped:r,express:i}=t,[o,c]=u.useState({width:0}),[m,l]=u.useState({x:0,width:-20}),f=v=>{switch(v){case A.PASSED:return"#aaa";case A.CURRENT:return"#f00";case A.FUTURE:return"#000"}},d=(y=(x=(g=e.en)==null?void 0:g.split("\\"))==null?void 0:x.length)!=null?y:1,h={g:{x:0,y:r?17.5:-20-d*14*Math.cos(-45)},StationSecondaryName:{x:(o.width+m.width/2+10)*(r?-1:1),y:2+5*(d-1)},ExpressTag:{x:(o.width+m.width+20+35)*(r?-1:1),y:2+5*(d-1)}};return a.jsxs("g",{textAnchor:r?"end":"start",fill:f(n),transform:"translate(".concat(h.g.x,",").concat(h.g.y,")rotate(-45)"),children:[a.jsx(qe,{stnName:e,onUpdate:c}),s&&a.jsx(Ke,{stnName:s,onUpdate:l,passed:n===A.PASSED,transform:"translate(".concat(h.StationSecondaryName.x,",").concat(h.StationSecondaryName.y,")")}),i&&a.jsx(Qe,{passed:n===A.PASSED,transform:"translate(".concat(h.ExpressTag.x,",").concat(h.ExpressTag.y,")")})]})}function tt(t){var x,y,v,j,p,_,S,$,E;const{stnId:e,stnState:s,stnY:n}=t,{theme:r,line_name:i,line_num:o,spanLineNum:c,stn_list:m}=b(T=>T.param),l=m[e],f=l.parents.length===2||l.children.length===2,d=n>0||l.parents.indexOf(((y=(x=l.branch)==null?void 0:x.left)==null?void 0:y[1])||"")===1||l.children.indexOf(((j=(v=l.branch)==null?void 0:v.right)==null?void 0:j[1])||"")===1?180:0,h=(S=(_=(p=l.localisedName.en)==null?void 0:p.split("\\"))==null?void 0:_.length)!=null?S:1,g=f?d===180?16+(h-1)*12*Math.cos(-45):-9:d===180?-6:(25+(h-1)*15)*Math.cos(-45);return a.jsxs(a.Fragment,{children:[a.jsx(nt,{intInfos:f?[{theme:[r[0],r[1],"var(--rmg-theme-colour)","var(--rmg-theme-fg)"],name:i},...($=l.transfer.groups[0].lines)!=null?$:[]]:(E=l.transfer.groups[0].lines)!=null?E:[],stnState:s,tickRotation:d,spanDigits:c}),a.jsx(se,{lineNum:o,stnNum:l.num,strokeColour:r[2],textClassName:"rmg-name__zh",passed:s===-1}),a.jsx("g",{transform:"translate(".concat(-g,",0)"),children:a.jsx(et,{primaryName:l.localisedName,secondaryName:l.localisedSecondaryName,stationState:s,flipped:d===180,express:l.services.includes(Oe.express)})})]})}const nt=t=>a.jsxs(a.Fragment,{children:[a.jsx(rt,{strokeWidth:4,...t}),a.jsx(at,{transform:"translate(0,".concat(t.tickRotation===180?-47:23,")"),...t})]}),rt=t=>{const{intInfos:e,stnState:s,tickRotation:n,spanDigits:r,...i}=t;return a.jsx("g",{...i,children:e.map((o,c)=>{var m;return a.jsx("use",{xlinkHref:"#inttick",stroke:s===-1?"#aaa":(m=o.theme)==null?void 0:m[2],transform:"translate(".concat(-2*(e.length-1)+4*c,",0)rotate(").concat(n===180?180:0,")")},c)})})},at=t=>{const{intInfos:e,tickRotation:s,stnState:n,spanDigits:r,...i}=t;return a.jsx("g",{...i,children:e.map((o,c)=>{var m,l,f,d;return a.jsx("g",{transform:"translate(0,".concat(c*28*(s===180?-1:1),")"),children:a.jsx(Se,{zhName:o.name[0],enName:o.name[1],foregroundColour:(l=(m=o.theme)==null?void 0:m[3])!=null?l:D.white,backgroundColour:(d=(f=o.theme)==null?void 0:f[2])!=null?d:"#aaaaaa",zhClassName:"rmg-name__zh",enClassName:"rmg-name__en",passed:n===-1,spanDigits:r})},c)})})},ye=(t,e)=>t[e].parents.length===2||t[e].children.length===2?.25:0,st=(t,e,s)=>{const n=w("linestart","lineend",e);if(n.nodes.includes(t))return w(n.nodes[1],t,e).len;{const r=s.filter(l=>l.includes(t))[0];let i=t;for(;!n.nodes.includes(i);)i=r[r.indexOf(i)-1];let o=t;for(;!n.nodes.includes(o);)o=r[r.indexOf(o)+1];const c=i==="linestart",m=o==="lineend";if(r.toString()===s[0].toString()){const l=[];return!c&&!m?(l[0]=w(n.nodes[1],i,e).len,l[1]=w(i,o,e).len,l[2]=w(i,t,e).len,l[3]=w(t,o,e).len):c?(l[0]=0,l[1]=w(n.nodes[1],o,e).len,l[2]=w(r[1],t,e).len,l[3]=w(t,o,e).len):(l[0]=w(n.nodes[1],i,e).len,l[1]=w(i,n.nodes.slice(-2)[0],e).len,l[2]=w(i,t,e).len,l[3]=w(t,r.slice(-2)[0],e).len),l[0]+l[2]*l[1]/(l[2]+l[3])}else if(!c&&!m){const l=[];return l[0]=w(n.nodes[1],i,e).len,l[1]=w(i,o,e).len,l[2]=w(i,t,e).len,l[3]=w(t,o,e).len,l[0]+l[2]*l[1]/(l[2]+l[3])}else return c?w(n.nodes[1],o,e).len-w(t,o,e).len:w(n.nodes[1],i,e).len+w(i,t,e).len}},it=()=>{const{branches:t,routes:e,depsStr:s}=b(z=>z.helper),{svgWidth:n,svg_height:r,y_pc:i,padding:o,branchSpacingPct:c,direction:m,line_name:l,spanLineNum:f,current_stn_idx:d,stn_list:h}=b(z=>z.param),g=Be(h,ye,ye),x=u.useMemo(()=>(console.log("computing x shares"),Object.keys(h).reduce((z,O)=>({...z,[O]:st(O,g,t)}),{})),[t.toString(),JSON.stringify(g)]),y=w("linestart","lineend",g),v=w(y.nodes[1],y.nodes.slice(-2)[0],g),j=m===N.right?[n[B.RailMap]*o/100+65,n[B.RailMap]*(1-o/100)-20]:[n[B.RailMap]*o/100,n[B.RailMap]*(1-o/100)-65],p=Object.keys(x).reduce((z,O)=>({...z,[O]:j[0]+x[O]/v.len*(j[1]-j[0])}),{}),_=u.useMemo(()=>(console.log("computing y shares"),Object.keys(h).reduce((z,O)=>{if(t[0].includes(O))return{...z,[O]:0};{const H=t.slice(1).filter(ze=>ze.includes(O))[0];return{...z,[O]:h[H[0]].children.indexOf(H[1])?-2:2}}},{})),[s]),S=Object.keys(_).reduce((z,O)=>({...z,[O]:-_[O]*c*r/200}),{}),$=u.useMemo(()=>$e(d,e,m),[d,m,e.toString()]),E=t.map(z=>Ce(z,$)).reduce((z,O)=>(z.main.push(O.main),z.pass.push(O.pass),z),{main:[],pass:[]}),T=Object.keys(E).reduce((z,O)=>({...z,[O]:E[O].map(H=>lt(H,p,S))}),{});return a.jsxs("g",{id:"main",style:{"--y-percentage":i,transform:"translateY(calc(var(--y-percentage) * var(--rmg-svg-height) / 100))"},children:[a.jsx(ot,{paths:T}),a.jsx(ct,{xs:p,ys:S,stnStates:$}),a.jsx("g",{id:"line_name",style:{"--translate-x":m===N.right?"".concat(j[0]-65,"px"):"".concat(j[1]+65,"px")},children:a.jsx(Se,{zhName:l[0],enName:l[1],foregroundColour:"var(--rmg-theme-fg)",backgroundColour:"var(--rmg-theme-colour)",zhClassName:"rmg-name__zh",enClassName:"rmg-name__en",spanDigits:f})})]})},ot=u.memo(function(e){return a.jsxs("g",{fill:"none",strokeWidth:4,children:[a.jsx("g",{stroke:"#aaa",strokeDasharray:4,children:e.paths.pass.map((s,n)=>a.jsx("path",{d:s},n))}),a.jsx("g",{stroke:"var(--rmg-theme-colour)",children:e.paths.main.map((s,n)=>a.jsx("path",{d:s},n))})]})},(t,e)=>JSON.stringify(t.paths)===JSON.stringify(e.paths)),lt=(t,e,s)=>{let n;const r=[];return t.forEach(i=>{const o=e[i],c=s[i];if(!n&&n!==0){n=c,r.push("M ".concat(o,",").concat(c));return}c===0?(c<n&&r.push("H ".concat(o-40),"a 40,40 0 0,0 40,-40","V ".concat(c)),c>n&&r.push("H ".concat(o-40),"a 40,40 0 0,1 40,40","V ".concat(c))):(c<n&&r.push("V ".concat(c+40),"a 40,40 0 0,1 40,-40","H ".concat(o)),c>n&&r.push("V ".concat(c-40),"a 40,40 0 0,0 40,40","H ".concat(o))),r.push("H ".concat(o)),n=c}),r.join(" ").replace(/( H ([\d.]+))+/g," H $2")},ct=t=>{const{xs:e,ys:s,stnStates:n}=t,r=b(i=>i.param.stn_list);return a.jsx("g",{id:"stn_icons",children:Object.keys(r).filter(i=>!["linestart","lineend"].includes(i)).map(i=>a.jsx("g",{style:{transform:"translate(".concat(e[i],"px,").concat(s[i],"px)")},children:a.jsx(tt,{stnId:i,stnState:n[i],stnY:s[i]})},i))})};function ie(t){return a.jsx("path",{d:"M60,60 L0,0 L60,-60 H90 L40,-10 H150 V10 H40 L90,60z",fill:"black",...t})}function mt(t){const{destIds:e,textAnchor:s,...n}=t,r=b(l=>l.param.direction),i=b(l=>l.param.stn_list),o=e.map(l=>{var f,d;return(d=(f=i[l].localisedName.zh)==null?void 0:f.length)!=null?d:0}),c=Math.min(...o),m=c>1&&o[0]!==o[1]?Math.abs(o[0]-o[1])/(c-1):0;return a.jsxs("g",{textAnchor:s,...n,children:[e.map((l,f)=>{var g;const d=o[f]>o[1-f],h=!Ee()&&s==="end"&&!d;return a.jsxs(u.Fragment,{children:[a.jsx("text",{className:"rmg-name__zh",fontSize:25,x:r===N.left?0:-75,y:-21+42*f,letterSpacing:d?"0em":"".concat(m,"em"),dx:h?"".concat(m,"em"):"0em",children:i[l].localisedName.zh}),a.jsx("text",{className:"rmg-name__en",fontSize:11.5,x:r===N.left?0:-75,y:-1+42*f,children:"Towards "+((g=i[l].localisedName.en)==null?void 0:g.replace("\\"," "))})]},l)}),a.jsx("text",{className:"rmg-name__zh",fontSize:28,x:r===N.left?25*(Math.max(...o)+1):0,y:5,children:"方向"})]})}const ve=B.RailMap,ut=()=>{const{canvasScale:t}=b(h=>h.app),{svgWidth:e,svg_height:s,direction:n,psd_num:r,info_panel_type:i,notesGZMTR:o,current_stn_idx:c,stn_list:m,theme:l}=b(h=>h.param),f=e[ve],d=m[c];return a.jsxs(pe,{type:ve,svgWidth:f,svgHeight:s,canvasScale:t,theme:l,children:[a.jsx(dt,{}),a.jsx(_e,{variant:i,isShowLight:i===P.gz2otis,isShowPSD:i===P.gz2otis&&r}),n===N.left&&d.parents.includes("linestart")||n===N.right&&d.children.includes("lineend")?a.jsx(xt,{}):a.jsxs(a.Fragment,{children:[a.jsx(it,{}),a.jsx(ft,{}),o==null?void 0:o.map((h,g)=>a.jsx(gt,{note:h},g))]}),i===P.gz2otis&&a.jsx("line",{x2:f,transform:"translate(0,90)",strokeWidth:3,stroke:"black"})]})},dt=u.memo(function(){return a.jsx("defs",{children:a.jsx("path",{id:"inttick",d:"M 0,0 v 18",strokeLinecap:"square"})})}),ft=()=>{const{routes:t}=b(c=>c.helper),{direction:e,direction_gz_x:s,direction_gz_y:n,current_stn_idx:r}=b(c=>c.param),i=u.useMemo(()=>[...new Set(t.reduce((c,m)=>m.includes(r)?c.concat(m.filter(l=>!["linestart","lineend"].includes(l)).slice(e===N.left?0:-1)[0]):c,[]).filter(c=>c!==r))],[r,e,t.toString()]),o={textAnchor:e===N.left?"start":"end",transform:"translate(".concat(e===N.left?65:-65,",-5)"),destIds:i};return a.jsxs("g",{id:"direction_gz",style:{"--x-percentage":s,"--y-percentage":n},children:[a.jsx(ie,{transform:"scale(0.35)rotate(".concat(e===N.left?0:180,")")}),i.length!==2?a.jsx(ht,{...o}):a.jsx(mt,{...o})]})},ht=t=>{const{destIds:e,...s}=t,n=b(r=>r.param.stn_list);return a.jsxs("g",{...s,children:[a.jsx("text",{className:"rmg-name__zh",fontSize:28,children:e.map(r=>n[r].localisedName.zh).join("/")+"方向"}),a.jsx("text",{className:"rmg-name__en",fontSize:14,dy:22,children:"Towards "+e.map(r=>{var i;return(i=n[r].localisedName.en)==null?void 0:i.replace("\\"," ")}).join("/")})]})},xt=u.memo(function(){return a.jsxs("g",{id:"terminus_gz",textAnchor:"middle",children:[a.jsx("text",{className:"rmg-name__zh",fontSize:90,children:"终 点 站"}),a.jsx("text",{dy:70,className:"rmg-name__en",fontSize:36,children:"Terminal"}),a.jsxs("g",{strokeWidth:8,stroke:"#000",children:[a.jsx("path",{d:"M -160,68 h -160"}),a.jsx("path",{d:"M 160,68 h 160"})]})]})}),gt=u.memo(function(e){const s=u.useRef(null),[n,r]=u.useState({width:0,height:0,y:0});return u.useEffect(()=>{s.current&&r(s.current.getBBox())},[e.note[0],e.note[1]]),a.jsxs("g",{className:"note-box",style:{"--x-percentage":e.note[2],"--y-percentage":e.note[3]},children:[e.note[4]&&a.jsx("rect",{height:n.height+4,width:n.width+4,x:-2,y:n.y-2,fill:"none",stroke:"black",strokeWidth:.5}),a.jsxs("g",{ref:s,children:[a.jsx("g",{fontSize:16,letterSpacing:1.2,children:e.note[0].split("\n").map((i,o)=>a.jsx("text",{className:"rmg-name__zh",y:o*18,children:i},o))}),a.jsx("g",{fontSize:10,letterSpacing:.33,transform:"translate(0,".concat(18*e.note[0].split("\n").length,")"),children:e.note[1].split("\n").map((i,o)=>{var c;return a.jsx("text",{className:"rmg-name__en",y:o*11,textLength:o<(((c=e.note[1].match(/\n/g))==null?void 0:c.length)||0)?n.width:navigator.userAgent.includes("Firefox")?-1:0,lengthAdjust:"spacing",children:i},o)})})]})]})},(t,e)=>t.note.toString()===e.note.toString()),yt=u.memo(function(e){var i,o;const{stnName:s,onUpdate:n}=e,r=u.useRef(null);return u.useEffect(()=>{r.current&&n&&n(r.current.getBBox())},[s.toString()]),a.jsxs("g",{ref:r,children:[a.jsx("text",{className:"rmg-name__zh",fontSize:90,children:s.zh}),a.jsx("g",{fontSize:36,children:(o=(i=s.en)==null?void 0:i.split("\\"))==null?void 0:o.map((c,m)=>a.jsx("text",{className:"rmg-name__en",dy:70+m*36,children:c},m))})]})},(t,e)=>JSON.stringify(t.stnName)===JSON.stringify(e.stnName)),vt=t=>{const{secondaryName:e,transform:s}=t,n=u.useRef(null),[r,i]=u.useState({x:0,width:0});return u.useEffect(()=>{n.current&&i(n.current.getBBox())},[e.toString()]),a.jsxs("g",{transform:s,children:[a.jsxs("g",{transform:"translate(0,4.5)",fontSize:36,children:[a.jsx("text",{textAnchor:"end",x:r.x-3,className:"rmg-name__zh",children:"("}),a.jsx("text",{textAnchor:"start",x:r.width+r.x+3,className:"rmg-name__zh",children:")"})]}),a.jsxs("g",{ref:n,textAnchor:"middle",children:[a.jsx("text",{className:"rmg-name__zh",fontSize:26,children:e.zh}),a.jsx("text",{dy:22,className:"rmg-name__en",fontSize:14,children:e.en})]})]})},pt=()=>{var y,v,j;const{svg_height:t,svgWidth:e,theme:s,direction:n,info_panel_type:r,line_num:i,current_stn_idx:o,stn_list:c}=b(p=>p.param),m=c[o],[l,f]=u.useState({width:0}),d=(j=(v=(y=m.localisedName.en)==null?void 0:y.split("\\"))==null?void 0:v.length)!=null?j:1,h=m[n===N.left?"parents":"children"],g={name:"translate(".concat((n===N.left?1:-1)*e[B.RunIn]/4,",45)"),next:"translate(".concat((n===N.left?1:-1)*e[B.RunIn]/10,",45)")},x={nameGroup:{x:e.runin/2,y:.5*t-50-(d-1)*18-(m.localisedSecondaryName?29:0)},secondaryName:{x:0,y:70+d*36}};return a.jsxs("g",{children:[a.jsxs("g",{transform:r===P.gz2otis?g.name:"",children:[a.jsxs("g",{textAnchor:"middle",transform:"translate(".concat(x.nameGroup.x,",").concat(x.nameGroup.y,")"),children:[a.jsx(yt,{stnName:m.localisedName,onUpdate:f}),m.localisedSecondaryName&&a.jsx(vt,{secondaryName:m.localisedSecondaryName,transform:"translate(".concat(x.secondaryName.x,",").concat(x.secondaryName.y,")")})]}),a.jsx(se,{lineNum:i,stnNum:m.num,strokeColour:s[2],textClassName:"rmg-name__zh",style:{"--translate-x":"".concat((e[B.RunIn]+l.width)/2+55,"px"),"--translate-y":"".concat(.5*t-30-(d-1)*18-(m.localisedSecondaryName?58/2:0),"px"),transform:"translate(var(--translate-x, 800px), var(--translate-y, 145px))"},size:"lg"})]}),a.jsx("g",{transform:r===P.gz2otis?g.next:"",children:!h||h.includes("linestart")||h.includes("lineend")?a.jsx(a.Fragment,{}):h.length===1?a.jsx(_t,{nextId:h[0],nameBBox:l}):a.jsx(St,{nextIds:h,nameBBox:l})})]})},_t=t=>{const{nextId:e,nameBBox:s}=t,n=b(y=>y.param.svgWidth),r=b(y=>y.param.direction),i=b(y=>y.param.stn_list[e]),{localisedName:o,localisedSecondaryName:c}=i,{zh:m="",en:l=""}=o,[f,d]=u.useState({width:0}),h=u.useRef(null);u.useEffect(()=>{h.current&&d(h.current.getBBox())},[m,l]);const g=m.length,x=(n[B.RunIn]-s.width)/2;return a.jsxs(a.Fragment,{children:[a.jsxs("g",{id:"big_next",children:[a.jsxs("g",{textAnchor:"middle",style:{"--translate-x":r===N.left?"80px":g<=2?"".concat(n[B.RunIn]-45-f.width-70,"px"):"".concat(n[B.RunIn]-45-f.width-35*1.5,"px")},children:[a.jsx("text",{className:"rmg-name__zh",fontSize:35,children:"下站"}),a.jsx("text",{className:"rmg-name__en",fontSize:17,dy:30,children:"Next"})]}),a.jsxs("g",{textAnchor:"start",ref:h,style:{"--translate-x":r===N.left?g<=2?"150px":"".concat(115+35/2,"px"):"".concat(n[B.RunIn]-45-f.width,"px")},children:[a.jsx("text",{className:"rmg-name__zh",fontSize:35,children:m}),a.jsx("g",{fontSize:17,children:l.split("\\").map((y,v)=>a.jsx("text",{className:"rmg-name__en",dy:30+v*17,children:y},v))})]}),c&&a.jsx("g",{textAnchor:"middle",style:{"--translate-x":r===N.left?g<=2?"150px":"".concat(115+35/2,"px"):"".concat(n[B.RunIn]-45-f.width,"px")},children:a.jsx(jt,{secName:c,transform:"translate(".concat(f.width/2,",").concat(30+l.split("\\").length*17+5,")")})})]}),a.jsx(ie,{id:"arrow",style:{"--translate-x":r===N.left?"".concat((115+35*((g<=2?1:.5)+g)+x)/2-20,"px"):"".concat((n[B.RunIn]-45-f.width-(g<=2?105:35*2.5)+x+t.nameBBox.width+55+18.5*1.4)/2+20,"px"),"--rotate":r===N.left?"0deg":"180deg"}})]})},jt=t=>{const{secName:e,...s}=t,{zh:n,en:r}=e,i=u.useRef(null),[o,c]=u.useState({x:0,width:0});return u.useEffect(()=>{i.current&&c(i.current.getBBox())},[n,r]),a.jsxs("g",{...s,children:[a.jsxs("g",{transform:"translate(0,2.5)",fontSize:25,children:[a.jsx("text",{textAnchor:"end",x:o.x-3,className:"rmg-name__zh",children:"("}),a.jsx("text",{textAnchor:"start",x:o.width+o.x+3,className:"rmg-name__zh",children:")"})]}),a.jsxs("g",{ref:i,children:[a.jsx("text",{className:"rmg-name__zh",fontSize:18,children:n}),a.jsx("text",{className:"rmg-name__en",fontSize:10,dy:15,children:r})]})]})},St=t=>{const{nextIds:e,nameBBox:s}=t,{routes:n}=b(x=>x.helper),r=b(x=>x.param.svgWidth),i=b(x=>x.param.direction),o=b(x=>x.param.stn_list),c=e.map(x=>o[x].localisedName),[m,l]=u.useState({width:0}),f=u.useRef([]);u.useEffect(()=>{l(x=>({...x,width:0})),f.current.forEach(x=>{const y=x==null?void 0:x.getBBox();l(v=>y?v.width>y.width?v:y:v)})},[c.toString()]);const d=t.nextIds.map(x=>n.reduce((y,v)=>v.includes(x)?y.concat(v.filter(j=>!["linestart","lineend"].includes(j)).slice(i===N.left?0:-1)[0]):y,[])),h=Math.max(...c.map(x=>{var y,v;return(v=(y=x.zh)==null?void 0:y.length)!=null?v:0})),g=(r[B.RunIn]-s.width)/2;return a.jsxs(a.Fragment,{children:[a.jsx("g",{id:"big_next_2",children:c.map((x,y)=>{var v,j;return a.jsxs(u.Fragment,{children:[a.jsxs("g",{textAnchor:"middle",style:{"--translate-x":i===N.left?"72px":"".concat(r[B.RunIn]-45-m.width-41,"px")},children:[a.jsx("text",{className:"rmg-name__zh",children:"下站"}),a.jsx("text",{className:"rmg-name__en",y:22,children:"Next"})]}),a.jsxs("g",{ref:p=>f.current[y]=p,textAnchor:"start",style:{"--translate-x":i===N.left?"113px":"".concat(r[B.RunIn]-45-m.width,"px")},children:[a.jsx("text",{className:"rmg-name__zh",children:x.zh}),(j=(v=x.en)==null?void 0:v.split("\\"))==null?void 0:j.map((p,_)=>a.jsx("text",{className:"rmg-name__en",y:22+_*13,children:p},_)),a.jsx("text",{className:"rmg-name__zh",y:-35,children:d[y].map(p=>o[p].localisedName.zh).join("/")+"方向"}),a.jsx("text",{className:"rmg-name__en rmg-name__gzmtr--next2-dest",y:-20,children:"Towards "+d[y].map(p=>o[p].localisedName.en).join("/").replace("\\"," ")})]})]},y)})}),a.jsx(ie,{id:"arrow",style:{"--translate-x":i===N.left?"".concat((99+27*(1+h)+g)/2-20,"px"):"".concat((r[B.RunIn]-45-m.width-41-27+g+t.nameBBox.width+55+18.5*1.4)/2+20,"px"),"--rotate":i===N.left?"0deg":"180deg"}})]})};function Nt(t){const{num:e,...s}=t;return a.jsxs("g",{textAnchor:"middle",fill:"var(--rmg-theme-fg)",...s,children:[a.jsx("circle",{cx:0,cy:0,r:30,fill:"var(--rmg-theme-colour)"}),a.jsx("text",{className:"rmg-name__en",fontSize:38,dy:-9.5,children:e}),a.jsx("text",{className:"rmg-name__zh",fontSize:13,dy:10,children:"站台"}),a.jsx("text",{className:"rmg-name__en",fontSize:9,dy:21,children:"Platform"})]})}function wt(t){const{canvasType:e}=t,{svgWidth:s,svg_height:n}=b(r=>r.param);return a.jsxs("g",{id:"otis_frame",strokeWidth:3,stroke:"black",children:[a.jsx("line",{y2:n,transform:"translate(".concat(s[e]/2,",0)")}),a.jsx("line",{x2:s[e],transform:"translate(0,90)"})]})}const Y=B.RunIn;function bt(){const{canvasScale:t}=b(f=>f.app),{svgWidth:e,svg_height:s,direction:n,info_panel_type:r,platform_num:i,psd_num:o,theme:c}=b(f=>f.param),m=e[Y],l={platform:"translate(".concat(n===N.left?50:-50,",45)")};return a.jsxs(pe,{type:Y,svgWidth:m,svgHeight:s,canvasScale:t,theme:c,children:[a.jsx(_e,{variant:r,isShowLight:r!==P.gz2otis,isShowPSD:r!==P.gz2otis&&o}),a.jsx("g",{transform:r===P.gz2otis?l.platform:"",children:a.jsx(Nt,{num:i,style:{"--translate-x":"".concat(n===N.left?m-100:100,"px"),"--translate-y":"calc(var(--rmg-svg-height) / 2 - 30px)",transform:"translate(var(--translate-x, 100px), var(--translate-y))"}})}),a.jsx(pt,{}),r===P.gz2otis&&a.jsx(wt,{canvasType:Y})]})}const Pt={runin:a.jsx(bt,{}),railmap:a.jsx(ut,{})};export{Pt as default};
