!function(){function t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function e(e){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?t(Object(s),!0).forEach(function(t){n(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):t(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function n(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}System.register(["./index-legacy-XhBWJhG2.js"],function(t,n){"use strict";var r;return{setters:[t=>{r=t.S}],execute:function(){t("a",(t,n,r)=>Object.keys(t).reduce((s,i)=>e(e({},s),{},{[i]:t[i].children.reduce((s,h)=>e(e({},s),{},{[h]:1+n(t,h)+r(t,i)}),{})}),{}));const n=t("c",(t,e,r)=>{if(t===e)return{len:0,nodes:[t]};const s=[],i=[];Object.keys(r[t]).forEach(h=>{const o=n(h,e,r);o.len<0||(s.push(r[t][h]+o.len),o.nodes.unshift(t),i.push(o.nodes))});const h=Math.max(...s);return{len:h,nodes:i[s.indexOf(h)]}}),s=(t("g",(t,e,r)=>{const s=n("linestart","lineend",e);if(s.nodes.includes(t))return n(s.nodes[1],t,e).len;{const i=r.filter(e=>e.includes(t))[0];let h=t;for(;!s.nodes.includes(h);)h=i[i.indexOf(h)-1];let o=t;for(;!s.nodes.includes(o);)o=i[i.indexOf(o)+1];const l="linestart"===h,c=[];return l||"lineend"===o?l?(c[0]=0,c[1]=n(s.nodes[1],o,e).len,c[2]=n(i[1],t,e).len,c[3]=n(t,o,e).len):(c[0]=n(s.nodes[1],h,e).len,c[1]=n(h,s.nodes.slice(-2)[0],e).len,c[2]=n(h,t,e).len,c[3]=n(t,i.slice(-2)[0],e).len):(c[0]=n(s.nodes[1],h,e).len,c[1]=n(h,o,e).len,c[2]=n(h,t,e).len,c[3]=n(t,o,e).len),c[0]+c[2]*c[1]/(c[2]+c[3])}}),(t,e,n)=>{for(const r of n){const n=r.indexOf(t),s=r.indexOf(e);if(-1!==s&&s<n)return!0}return!1}),i=(t,e,n)=>{for(const r of n){const n=r.indexOf(t),s=r.indexOf(e);if(-1!==n&&n<s)return!0}return!1};t("b",(t,n,h)=>(console.log("computing stations' states"),[...new Set([].concat(...n))].reduce((o,l)=>e(e({},o),{},{[l]:l===t?0:(h===r.right?i(t,l,n):s(t,l,n))?1:-1}),{})));t("S",class{constructor(t){this.yShares={},this.xShares={},this.namePoss={},this.stnList={},this.criticalPath={},this.leftWideFactor=t=>0,this.rightWideFactor=t=>0,this.pathTurnParams=t=>{const e=35-17.5*Math.sqrt(3),n=t-2*e;return{tr:35,dx_a:17.5,dy_a:e,dx_l:n*Math.sqrt(3),dy_l:n}},this.pathTurnSE=t=>{const{tr:e,dx_a:n,dy_a:r,dx_l:s,dy_l:i}=this.pathTurnParams(t);return`a ${e},${e} 0 0,1 ${n},${r} l ${s},${i} a ${e},${e} 0 0,0 ${n},${r}`},this.pathTurnNE=t=>{const{tr:e,dx_a:n,dy_a:r,dx_l:s,dy_l:i}=this.pathTurnParams(t);return`a ${e},${e} 0 0,0 ${n},${-r} l ${s},${-i} a ${e},${e} 0 0,1 ${n},${-r}`},this.stnList=t.stnList,this.criticalPath=t.criticalPath}getYShare(t){if(t in this.yShares)return this.yShares[t];if(["linestart","lineend"].includes(t)||this.stnList[t].parents.length>1||this.stnList[t].children.length>1)return this.yShares[t]=0,0;const e=this.stnList[t].parents[0];if(e){if(1===this.stnList[e].children.length){const n=this.getYShare(e);return this.yShares[t]=n,n}{const n=0===this.stnList[e].children.indexOf(t)?1:-1;return this.yShares[t]=n,n}}return this.yShares[t]=0,0}static getYShares(t){console.log("computing y shares");const e=new this({stnList:t});return Object.keys(t).forEach(t=>{["linestart","lineend"].includes(t)||t in e.yShares||e.getYShare(t)}),e.yShares}_linePath(t,e,n,r,s,i,h,o){let[l,c,a]=[];const u=[],{dx_a:d,dx_l:f}=this.pathTurnParams(i),p=d+f/2,y=(e[1]-e[0])/h.len*2,g=((e[1]-e[0])/h.len-2*p)/2;return g+y<0&&console.warn(`SVG width too small! ${g+y}`),t.forEach(e=>{const h=r[e],d=s[e];if(!c&&0!==c)return[l,a,c]=[e,h,d],void(1===t.length?u.push(`M ${h},${d}`):n[0].includes(e)?n[0].includes(t[1])?u.push(`M ${h},${d}`):(r[t[1]]>0&&u.push(`M ${h},${d+o}`),s[t[1]]<0&&u.push(`M ${h},${d-o}`)):u.push(`M ${h},${d}`));d>c?(u.push(0===d?"h "+(h-a-y*this.leftWideFactor(e)-g-2*p):`h ${y*this.rightWideFactor(l)+g}`),u.push(this.pathTurnSE(i))):d<c&&(u.push(0===d?"h "+(h-a-y*this.leftWideFactor(e)-g-2*p):`h ${y*this.rightWideFactor(l)+g}`),u.push(this.pathTurnNE(i))),u.push(`H ${h}`),[l,a,c]=[e,h,d]}),u.join(" ").replace(/( H ([\d.]+))+/g," H $2")}});t("d",(t,e)=>{let n=(t=t.filter(t=>!["linestart","lineend"].includes(t))).filter(t=>e[t]>=0),r=t.filter(t=>e[t]<=0);return 1===n.length&&(r=t),0===n.filter(t=>-1!==r.indexOf(t)).length&&n.length&&(r[0]===t[0]?r.push(n[0]):n[0]===t[0]&&n[n.length-1]===t[t.length-1]&&r.length?(r=t,n=[]):r.unshift(n[n.length-1])),{main:n,pass:r}})}}})}();
